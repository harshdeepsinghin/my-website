{{ define "main" }}
<div class="prompt-detail">
    <!-- Header -->
    <div class="prompt-header">
        <a href="/prompts/" class="prompt-back">‚Üê Back to Prompts</a>
        <span class="prompt-category-badge">{{ .Params.category }}</span>
        <h1>{{ .Title }}</h1>
        <p class="prompt-description">{{ .Params.description }}</p>
    </div>

    <!-- Two Column Layout -->
    <div class="prompt-layout">
        <!-- LEFT COLUMN: Prompt + Preview -->
        <div class="prompt-left">
            <!-- Prompt Template Display -->
            <div class="prompt-section">
                <h2>Prompt Template</h2>
                <div class="prompt-template" id="prompt-template">
                    <pre>{{- (.RawContent | strings.TrimPrefix "---\n" | replaceRE "(?s)^.*?---\n" "") | safeHTML -}}</pre>
                </div>
            </div>

            <!-- Preview -->
            <div class="prompt-section">
                <h2>Preview</h2>
                <div class="prompt-preview" id="prompt-preview">
                    Fill in the parameters to see the final prompt.
                </div>
                <button type="button" class="copy-btn" id="copy-prompt">Copy to Clipboard</button>
            </div>
        </div>

        <!-- RIGHT COLUMN: Parameters + AI Buttons -->
        <div class="prompt-right">
            <!-- Dynamic Form -->
            <div class="prompt-section">
                <h2>Fill Parameters</h2>
                <form id="prompt-form" class="prompt-form">
                    <!-- Form inputs will be generated by JavaScript -->
                </form>
            </div>

            <!-- AI Execution Buttons -->
            <div class="prompt-section">
                <h2>Execute with AI</h2>
                <div class="ai-buttons" id="ai-buttons">
                    {{ range .Params.ai }}
                    <button type="button" class="ai-btn ai-btn-{{ . }}" data-ai="{{ . }}">
                        {{ if eq . "chatgpt" }}ü§ñ ChatGPT{{ end }}
                        {{ if eq . "perplexity" }}üîç Perplexity{{ end }}
                        {{ if eq . "gemini" }}‚ú® Gemini{{ end }}
                        {{ if eq . "phind" }}üíª Phind{{ end }}
                    </button>
                    {{ end }}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Store raw prompt content for JavaScript -->
<script id="prompt-raw" type="text/plain">
{{- (.RawContent | strings.TrimPrefix "---\n" | replaceRE "(?s)^.*?---\n" "") | safeHTML -}}
</script>

<script src="/js/prompts.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        initPromptPage();
    });
</script>
{{ end }}